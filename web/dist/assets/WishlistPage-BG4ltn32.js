import{r as d,a0 as I,h as $,a6 as l,j as e,m as F,O as D,B as x,L as v,D as K,a2 as N,d as M,J as _,f as U,y as Z,w as O,q as V,H as u,g as T,X as ee}from"./index-DrzvgQSx.js";import{D as se,a as ae,b as re,c as te}from"./dialog-B_H0D0bM.js";import{C as B}from"./circle-alert-D5MbGcH3.js";import{T as q}from"./trash-2-DF_8SWob.js";import{E as ie}from"./eye-DtInb1xn.js";import{M as le}from"./minus-BZn02uM1.js";import{P as oe}from"./plus-CdXz1Jo6.js";import{C as ne}from"./circle-check-big-Cc93Cm_Q.js";const ve=()=>{const[m,b]=d.useState([]),[L,A]=d.useState(!0),[a,w]=d.useState(null),[z,p]=d.useState(!1),[h,k]=d.useState({}),[y,C]=d.useState(1),[S,j]=d.useState(!1),{addToCart:E}=I();d.useEffect(()=>{H()},[]);const H=async()=>{try{A(!0);const r=(await $.get("/get-wishlist/")).data;!r.error&&r.data?b(r.data):l.error(r.data)}catch(s){console.error("Error fetching wishlist:",s),l.error("Failed to load wishlist")}finally{A(!1)}},R=async(s,r)=>{if(window.confirm(`Are you sure you want to remove "${r}" from your wishlist?`))try{const i=(await $.post("/delete-wishlist/",{id:s})).data;!i.error&&i.data?(b(m.filter(o=>o.id!==s)),l.success("Item removed from wishlist")):l.error(i.data)}catch(t){console.error("Error removing from wishlist:",t),l.error("Failed to remove item")}},W=async()=>{if(window.confirm("Are you sure you want to clear your entire wishlist?"))try{const r=(await $.post("/clear-wishlist/")).data;!r.error&&r.data?(b([]),l.success("Wishlist cleared")):l.error(r.data)}catch(s){console.error("Error clearing wishlist:",s),l.error("Failed to clear wishlist")}},Q=s=>{if(w(s),s.variants&&s.variants.length>0){const r={};s.variants.forEach(t=>{t.options&&t.options.length>0&&(r[t.type]=t.options[0].value)}),k(r)}else k({});C(1),p(!0)},Y=()=>{if(a){j(!0);try{const s=[];a.variants&&a.variants.length>0&&a.variants.forEach(i=>{var c;const o=h[i.type],n=(c=i.options)==null?void 0:c.find(g=>g.value===o);n&&s.push({type:i.type,value:n.value,priceModifier:parseFloat(n.price_modifier||"0")})});const r=a.variants&&a.variants.length>0;E(a,y,h,s,r)&&(l.success(`${a.name} has been added to your cart!`),p(!1),w(null))}catch{l.error("Failed to add item to cart")}finally{j(!1)}}},J=()=>{if(a){j(!0);try{const s=[];a.variants&&a.variants.length>0&&a.variants.forEach(i=>{var c;const o=h[i.type],n=(c=i.options)==null?void 0:c.find(g=>g.value===o);n&&s.push({type:i.type,value:n.value,priceModifier:parseFloat(n.price_modifier||"0")})});const r=a.variants&&a.variants.length>0;E(a,y,h,s,r)&&(l.success(`${a.name} has been added to your cart!`),p(!1),w(null),window.location.href="/checkout")}catch{l.error("Failed to add item to cart")}finally{j(!1)}}},P=()=>!(a!=null&&a.variants)||a.variants.length===0?!0:a.variants.every(s=>h[s.type]),X=(s,r)=>{let t=s.price;return s.variants&&s.variants.length>0&&s.variants.forEach(i=>{var o;if(i.type&&r[i.type]){const n=r[i.type],c=(o=i.options)==null?void 0:o.find(g=>g.value===n);c&&c.price_modifier&&(t+=parseFloat(c.price_modifier))}}),t},G=s=>!s.originalPrice||s.originalPrice<=s.price?0:Math.round((s.originalPrice-s.price)/s.originalPrice*100),f=a?X(a,h):0;return(a==null?void 0:a.originalPrice)&&a.originalPrice>f&&(a!=null&&a.originalPrice)&&Math.round((a.originalPrice-f)/a.originalPrice*100),L?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block h-12 w-12 animate-spin rounded-full border-4 border-primary border-t-transparent"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"Loading your wishlist..."})]})}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsxs(F.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"inline-flex items-center justify-center gap-3 mb-2",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-gradient-to-br from-primary/10 to-accent/10 flex items-center justify-center",children:e.jsx(D,{className:"h-6 w-6 text-primary"})}),e.jsxs("h1",{className:"font-display text-3xl md:text-4xl font-bold",children:["My ",e.jsx("span",{className:"text-gradient",children:"Wishlist"})]})]}),e.jsx("p",{className:"text-muted-foreground",children:m.length===0?"Save your favorite beauty essentials for later":`You have ${m.length} item${m.length!==1?"s":""} saved`})]}),m.length===0?e.jsxs(F.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"text-center py-16",children:[e.jsxs("div",{className:"relative inline-block mb-6",children:[e.jsx(D,{className:"h-20 w-20 text-muted-foreground/40"}),e.jsx("div",{className:"absolute -inset-4 bg-gradient-to-r from-primary/5 to-accent/5 rounded-full blur-2xl"})]}),e.jsx("h3",{className:"font-display text-2xl font-semibold mb-2",children:"Your wishlist is empty"}),e.jsx("p",{className:"text-muted-foreground mb-8 max-w-sm mx-auto",children:"Save items you love to create your personalized beauty collection"}),e.jsx(x,{asChild:!0,className:"bg-gradient-to-r from-primary to-accent",children:e.jsx(v,{to:"/products",children:"Explore Products"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:e.jsx(K,{children:m.map((s,r)=>{const t=G(s);return e.jsx(F.div,{layout:!0,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{delay:r*.05},className:"group relative",children:e.jsxs("div",{className:"relative bg-card rounded-2xl overflow-hidden border border-border/30 hover:border-primary/30 hover:shadow-card-hover transition-all duration-300",children:[e.jsxs("div",{className:"relative aspect-square overflow-hidden bg-gradient-to-br from-muted/20 to-muted/5",children:[e.jsxs(v,{to:`/product/${s.id}/${N(s.name)}`,className:"block",children:[e.jsx("img",{src:M(s.image),alt:s.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-foreground/20 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),e.jsxs("div",{className:"absolute top-3 left-3 flex flex-col gap-1",children:[s.isNew&&e.jsxs(_,{className:"bg-gradient-to-r from-primary to-accent text-white shadow-md text-xs px-2 py-1",children:[e.jsx(U,{className:"h-3 w-3 mr-1"}),"New"]}),t>0&&e.jsxs(_,{className:"bg-gradient-to-r from-destructive to-destructive/90 text-white shadow-md text-xs px-2 py-1",children:["-",t,"%"]}),!s.inStock&&e.jsxs(_,{variant:"secondary",className:"bg-white/95 text-foreground shadow-md text-xs px-2 py-1",children:[e.jsx(B,{className:"h-3 w-3 mr-1"}),"Out of Stock"]})]}),e.jsx("button",{onClick:()=>R(s.id,s.name),className:"absolute top-3 right-3 w-9 h-9 rounded-full bg-white/90 backdrop-blur-sm flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300 hover:bg-destructive hover:text-white hover:scale-110","aria-label":"Remove from wishlist",children:e.jsx(q,{className:"h-4 w-4"})}),e.jsx(v,{to:`/product/${s.id}/${N(s.name)}`,className:"absolute bottom-3 right-3 w-9 h-9 rounded-full bg-white/90 backdrop-blur-sm flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300 hover:bg-primary hover:text-white hover:scale-110","aria-label":"View product",children:e.jsx(ie,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:s.category})}),e.jsx("h3",{className:"font-medium text-sm mb-2 line-clamp-2 group-hover:text-primary transition-colors",children:e.jsx(v,{to:`/product/${s.id}/${N(s.name)}`,children:s.name})}),s.rating&&e.jsxs("div",{className:"flex items-center gap-1 mb-3",children:[e.jsx("div",{className:"flex items-center",children:[...Array(5)].map((i,o)=>e.jsx(Z,{className:O("h-3 w-3",o<Math.floor(Number(s.rating))?"fill-yellow-400 text-yellow-400":"fill-muted/20 text-muted")},`${o}-${V()}`))}),e.jsx("span",{className:"text-xs text-muted-foreground ml-1",children:Number(s.rating).toFixed(1)})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("span",{className:"font-display text-lg text-primary",children:u(s.price)}),s.originalPrice&&e.jsx("span",{className:"text-sm text-muted-foreground line-through",children:u(s.originalPrice)})]}),e.jsxs(x,{className:"w-full bg-gradient-to-r from-primary to-accent hover:shadow-md transition-all",size:"sm",disabled:!s.inStock,onClick:()=>Q(s),children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),s.inStock?"Add to Cart":"Out of Stock"]}),s.stock==="low"&&s.inStock&&e.jsxs("p",{className:"text-xs text-destructive mt-2 flex items-center gap-1",children:[e.jsx(B,{className:"h-3 w-3"}),"Low Stock"]})]})]})},s.id)})})}),m.length>0&&e.jsx("div",{className:"text-center pt-8",children:e.jsxs(x,{variant:"outline",onClick:W,className:"border-destructive/20 text-destructive hover:bg-destructive/10",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Clear All Items"]})})]}),e.jsx(se,{open:z,onOpenChange:p,children:e.jsxs(ae,{className:"sm:max-w-md",children:[e.jsx(re,{children:e.jsxs(te,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Add to Cart"}),e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>p(!1),className:"h-8 w-8",children:e.jsx(ee,{className:"h-4 w-4"})})]})}),a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-xl overflow-hidden flex-shrink-0 bg-gradient-to-br from-muted/20 to-muted/5",children:e.jsx("img",{src:M(a.image),alt:a.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-sm line-clamp-2",children:a.name}),e.jsxs("div",{className:"flex items-baseline gap-2 mt-1",children:[e.jsx("span",{className:"font-display text-lg text-primary",children:u(f)}),a.originalPrice&&a.originalPrice>f&&e.jsx("span",{className:"text-xs text-muted-foreground line-through",children:u(a.originalPrice)}),a.variants&&a.variants.length>0&&f!==a.price&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(Base: ",u(a.price),")"]})]})]})]}),a.variants&&a.variants.length>0&&e.jsx("div",{className:"space-y-4",children:a.variants.map(s=>e.jsxs("div",{children:[e.jsx("label",{className:"font-medium text-sm mb-2 block",children:s.type}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.options&&s.options.map(r=>e.jsxs("button",{onClick:()=>k(t=>({...t,[s.type]:r.value})),className:O("px-3 py-2 rounded-lg border text-sm font-medium transition-all flex items-center gap-2","hover:border-primary/50 hover:scale-105",h[s.type]===r.value?"border-primary bg-primary/10 text-primary shadow-sm":"border-border"),children:[r.value,r.price_modifier&&e.jsx("span",{className:"text-xs opacity-75",children:parseFloat(r.price_modifier)>0?`+${u(parseFloat(r.price_modifier))}`:u(parseFloat(r.price_modifier))})]},`${r.value}-${V()}`))})]},`${s.type}-${V()}`))}),e.jsxs("div",{children:[e.jsx("label",{className:"font-medium text-sm mb-3 block",children:"Quantity"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center border rounded-lg",children:[e.jsx("button",{onClick:()=>C(s=>Math.max(1,s-1)),className:"p-3 hover:bg-muted transition-colors disabled:opacity-50 rounded-l-lg",disabled:y<=1,children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx("span",{className:"w-12 text-center font-medium",children:y}),e.jsx("button",{onClick:()=>C(s=>s+1),className:"p-3 hover:bg-muted transition-colors rounded-r-lg",children:e.jsx(oe,{className:"h-4 w-4"})})]}),e.jsx("span",{className:"text-sm",children:a.inStock?e.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(ne,{className:"h-4 w-4"})," In Stock"]}):e.jsx("span",{className:"text-red-600",children:"Out of Stock"})})]})]}),a.variants&&a.variants.length>0&&!P()&&e.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-yellow-800",children:"Please select all available variants before adding to cart"})}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsx(x,{className:"flex-1 bg-gradient-to-r from-primary to-accent",onClick:Y,disabled:!P()||!a.inStock||S,children:S?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent mr-2"}),"Adding..."]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Add to Cart"]})}),e.jsx(x,{variant:"outline",className:"flex-1",onClick:J,disabled:!P()||!a.inStock||S,children:"Buy Now"})]}),e.jsx(x,{variant:"ghost",className:"w-full",onClick:()=>{p(!1)},asChild:!0,children:e.jsx(v,{to:`/product/${a.id}/${N(a.name)}`,children:"View Full Details"})})]})]})})]})};export{ve as default};

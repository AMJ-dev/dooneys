import{r as c,U as M,d as _,j as e,m as q,a4 as B,w as W,B as b,X as A,v as h,x as S,a6 as l,h as U}from"./index-DrzvgQSx.js";import{L as f}from"./label-D6nqg-AK.js";import{C as k,d as I}from"./card-CSdj4VlM.js";import{S as L}from"./separator-DpYAwveS.js";import{L as N}from"./loader-circle-oXQTLidO.js";import{C as R}from"./camera-D3qhaZ7q.js";import{U as O}from"./upload-DzFS-i39.js";const V=()=>{const{my_details:i,setMyDetails:P}=c.useContext(M),[s,d]=c.useState({id:i.id||"",first_name:i.first_name||"",last_name:i.last_name||"",email:i.email||"",mobile_number:i.mobile_number||"",dob:i.dob||"",pics:i.pics||""}),[v,C]=c.useState(!1),[m,F]=c.useState(!1),[u,p]=c.useState(""),x=c.useRef(null),[g,y]=c.useState(null);c.useEffect(()=>{s.pics&&p(_(s.pics))},[s.pics]);const E=a=>{var t;const r=(t=a.target.files)==null?void 0:t[0];if(!r)return;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(r.type)){l.error("Please select a valid image file (JPG, PNG, GIF, WebP)");return}const n=5*1024*1024;if(r.size>n){l.error("Image size must be less than 5MB");return}y(r);const o=URL.createObjectURL(r);p(o)},z=async()=>{var a;if(!g){l.error("Please select an image first");return}try{F(!0);const r=new FormData;r.append("pics",g);const n=(await U.post("/update-pics/",r,{headers:{"Content-Type":"multipart/form-data"}})).data;if(!n.error&&n.data){const o=((a=n.code)==null?void 0:a.pics)||n.data.pics||s.pics;P({...i,pics:o}),d(t=>({...t,pics:o})),u.startsWith("blob:")&&URL.revokeObjectURL(u),p(_(o)),y(null),l.success("Profile picture updated successfully!")}else l.error(n.data||"Failed to upload image")}catch(r){console.error("Error uploading image:",r),l.error("Failed to upload image. Please try again.")}finally{F(!1)}},D=()=>{u.startsWith("blob:")&&URL.revokeObjectURL(u),y(null),s.pics?p(_(s.pics)):p(""),x.current&&(x.current.value="")},G=async()=>{var r,j,n,o;if(!((r=s.first_name)!=null&&r.trim())||!((j=s.last_name)!=null&&j.trim())){l.error("First name and last name are required");return}const a=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(s.email&&!a.test(s.email)){l.error("Please enter a valid email address");return}if(s.mobile_number&&!/^[\d\s\-\+\(\)]{10,15}$/.test(s.mobile_number)){l.error("Please enter a valid phone number");return}try{C(!0);const t=new FormData;t.append("first_name",s.first_name.trim()),t.append("last_name",s.last_name.trim()),s.email&&t.append("email",s.email.trim()),s.mobile_number&&t.append("mobile_number",s.mobile_number.trim()),s.dob&&t.append("dob",s.dob);const w=(await U.post("/update-profile/",t)).data;!w.error&&w.data?(P({...i,first_name:s.first_name.trim(),last_name:s.last_name.trim(),email:((n=s.email)==null?void 0:n.trim())||i.email,mobile_number:((o=s.mobile_number)==null?void 0:o.trim())||i.mobile_number,dob:s.dob||i.dob}),l.success("Profile updated successfully!")):l.error(w.data||"Failed to update profile")}catch(t){console.error("Error updating profile:",t),l.error("Failed to update profile. Please try again.")}finally{C(!1)}};return e.jsxs(q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-8",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"font-display text-2xl md:text-3xl font-bold",children:"Profile Settings"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your personal information and profile photo"})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(k,{className:"border-0 shadow-soft bg-white/50 backdrop-blur-sm",children:e.jsx(I,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-display text-lg font-semibold mb-4",children:"Profile Photo"}),e.jsxs("div",{className:"relative inline-block group",children:[e.jsx("div",{className:"w-32 h-32 rounded-full overflow-hidden bg-gradient-to-br from-primary/10 to-accent/10 flex items-center justify-center",children:u?e.jsx("img",{src:u,alt:"Profile",className:"w-full h-full object-cover"}):e.jsx(B,{className:"h-16 w-16 text-primary/40"})}),e.jsx("button",{onClick:()=>{var a;return(a=x.current)==null?void 0:a.click()},className:W("absolute bottom-0 right-0 w-10 h-10 rounded-full flex items-center justify-center shadow-lg transition-all duration-300","bg-gradient-to-r from-primary to-accent text-white","hover:scale-110 hover:shadow-xl active:scale-95"),disabled:m,children:m?e.jsx(N,{className:"h-4 w-4 animate-spin"}):e.jsx(R,{className:"h-4 w-4"})}),e.jsx("input",{ref:x,type:"file",accept:"image/*",onChange:E,className:"hidden",disabled:m}),g&&e.jsx("div",{className:"absolute -top-2 -right-2",children:e.jsx("div",{className:"h-6 w-6 rounded-full bg-primary text-white flex items-center justify-center",children:e.jsx("div",{className:"h-3 w-3 rounded-full bg-white animate-pulse"})})})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("span",{className:"font-medium text-foreground",children:"File requirements:"}),e.jsx("br",{}),"• JPG, PNG, GIF, or WebP",e.jsx("br",{}),"• Max file size: 5MB",e.jsx("br",{}),"• Recommended: Square image, at least 400x400px"]}),e.jsx("div",{className:"flex flex-col gap-2 pt-2",children:g?e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{onClick:z,disabled:m,className:"flex-1 bg-gradient-to-r from-primary to-accent hover:shadow-md",children:m?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"h-4 w-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Upload Photo"]})}),e.jsx(b,{variant:"outline",size:"icon",onClick:D,disabled:m,className:"flex-shrink-0 border-destructive/20 text-destructive hover:bg-destructive/10",children:e.jsx(A,{className:"h-4 w-4"})})]}):e.jsxs(b,{variant:"outline",className:"w-full",onClick:()=>{var a;return(a=x.current)==null?void 0:a.click()},children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Choose Photo"]})})]})]}),e.jsx(L,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-muted-foreground mb-2",children:"Account Information"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Member Since"}),e.jsx("span",{className:"font-medium",children:"—"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Profile Status"}),e.jsx("span",{className:"font-medium text-green-600",children:"Active"})]})]})]})]})})})}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx(k,{className:"border-0 shadow-soft bg-white/50 backdrop-blur-sm",children:e.jsxs(I,{className:"p-6",children:[e.jsx("h3",{className:"font-display text-lg font-semibold mb-6",children:"Personal Information"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"first_name",className:"font-medium",children:"First Name *"}),e.jsx(h,{id:"first_name",value:s.first_name,onChange:a=>d({...s,first_name:a.target.value}),placeholder:"Enter your first name",className:"h-11",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"last_name",className:"font-medium",children:"Last Name *"}),e.jsx(h,{id:"last_name",value:s.last_name,onChange:a=>d({...s,last_name:a.target.value}),placeholder:"Enter your last name",className:"h-11",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"email",className:"font-medium",children:"Email Address"}),e.jsx(h,{id:"email",type:"email",value:s.email,onChange:a=>d({...s,email:a.target.value}),placeholder:"your.email@example.com",className:"h-11"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Your email address is used for account notifications and password recovery"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"mobile_number",className:"font-medium",children:"Phone Number"}),e.jsx(h,{id:"mobile_number",type:"tel",value:s.mobile_number,onChange:a=>d({...s,mobile_number:a.target.value}),placeholder:"+1 (555) 123-4567",className:"h-11"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Used for delivery notifications and account security"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"dob",className:"font-medium",children:"Date of Birth"}),e.jsx(h,{id:"dob",type:"date",value:s.dob,onChange:a=>d({...s,dob:a.target.value}),className:"h-11 max-w-xs"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Used for personalized offers and birthday surprises"})]}),e.jsx(L,{}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:e.jsx(b,{onClick:G,disabled:v||m,className:"sm:flex-1 bg-gradient-to-r from-primary to-accent hover:shadow-md",children:v?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Save Changes"]})})}),(v||m)&&e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(N,{className:"h-3 w-3 animate-spin"}),"Please wait while we save your changes..."]})]})]})}),e.jsx("div",{className:"mt-4 p-4 rounded-lg bg-gradient-to-r from-primary/5 to-accent/5 border border-primary/10",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"h-6 w-6 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx(S,{className:"h-3 w-3 text-primary"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-1",children:"Your data is secure"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All your personal information is encrypted and protected. We never share your data with third parties."})]})]})})]})]})]})};export{V as default};

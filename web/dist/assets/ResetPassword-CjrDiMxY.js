import{F as Q,E as V,r as o,h as k,a6 as c,j as e,ap as ee,o as se,m as i,N as L,w as m,D as E,B as j,A as R,v as q,x as A,X as F,C as ae}from"./index-DrzvgQSx.js";import{L as M}from"./label-D6nqg-AK.js";import{C as re,a as te,b as oe,c as ie,d as ne,e as le}from"./card-CSdj4VlM.js";import{S as de}from"./separator-DpYAwveS.js";import{K as ce}from"./key-DLVskWgd.js";import{C as me}from"./circle-check-DSb9V_JN.js";import{L as O}from"./loader-circle-oXQTLidO.js";import{L as h}from"./lock-DWWiw9OW.js";import{E as z}from"./eye-off-MxEi3Of0.js";import{E as I}from"./eye-DtInb1xn.js";import{C as D}from"./circle-alert-D5MbGcH3.js";const ve=()=>{const u=Q(),{link1:f,link2:g}=V(),[r,T]=o.useState({password:"",cpassword:""}),[y,N]=o.useState(!1),[B,H]=o.useState(!1),[w,U]=o.useState(!1),[b,$]=o.useState(!1),[G,v]=o.useState(!1),[K,C]=o.useState(!1),[l,S]=o.useState({}),[t,Y]=o.useState(0),[x,Z]=o.useState({length:!1,uppercase:!1,lowercase:!1,number:!1,special:!1});o.useEffect(()=>{if(f&&g){v(!0);try{(async()=>{const a=(await k.post("/check-link/",{link1:f,link2:g})).data;(a==null?void 0:a.error)===!1&&(a!=null&&a.data)||(c.error((a==null?void 0:a.data)||"Invalid or expired reset link"),o.startTransition(()=>u("/forgot-password")))})()}catch{c.error("Failed to validate reset link")}finally{v(!1)}}},[f,g,u]),o.useEffect(()=>{(a=>{const n={length:a.length>=8,uppercase:/[A-Z]/.test(a),lowercase:/[a-z]/.test(a),number:/[0-9]/.test(a),special:/[^A-Za-z0-9]/.test(a)};Z(n);const d=Object.values(n).filter(Boolean).length/5*100;Y(d)})(r.password)},[r.password]);const W=()=>t>=80?"bg-emerald-500":t>=60?"bg-amber-500":t>=40?"bg-orange-500":"bg-red-500",X=()=>t>=80?"Strong":t>=60?"Good":t>=40?"Fair":"Weak",_=()=>{const s={};return r.password?t<80&&(s.password="Please meet all password requirements"):s.password="Password is required",r.cpassword?r.password!==r.cpassword&&(s.cpassword="Passwords do not match"):s.cpassword="Please confirm your password",S(s),Object.keys(s).length===0},P=(s,a)=>{T(n=>({...n,[s]:a})),l[s]&&S(n=>({...n,[s]:""}))},J=async s=>{var a,n;if(s.preventDefault(),!_()){c.error("Please fix the errors in the form");return}N(!0);try{const d=(await k.post("/reset-password/",{link1:f,link2:g,password:r.password,cpassword:r.cpassword,where:"reset-link"})).data;d.error===!1?(c.success("Password reset successfully!"),H(!0),setTimeout(()=>u("/login"),3e3)):c.error(d.data||"Failed to reset password")}catch(p){const d=((n=(a=p==null?void 0:p.response)==null?void 0:a.data)==null?void 0:n.message)||"An error occurred. Please try again.";c.error(d)}finally{N(!1)}};return G?e.jsx(ee,{}):e.jsx(se,{children:e.jsxs("section",{className:"min-h-screen flex items-center justify-center px-4 py-12 bg-gradient-to-br from-background via-background to-primary/5",children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(6)].map((s,a)=>e.jsx(i.div,{className:"absolute rounded-full bg-gradient-to-r from-primary/10 to-accent/10",style:{width:Math.random()*100+50,height:Math.random()*100+50,left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[0,-30,0],x:[0,Math.random()*20-10,0]},transition:{duration:Math.random()*10+10,repeat:1/0,ease:"easeInOut"}},a))}),e.jsxs(i.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5},className:"w-full max-w-md",children:[e.jsx(i.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.2},className:"flex items-center justify-center gap-2 mb-6",children:e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-primary/10 to-accent/10 backdrop-blur-sm rounded-full border border-primary/20",children:[e.jsx(L,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Secure Password Reset"})]})}),e.jsxs(re,{className:"relative bg-gradient-to-b from-card/90 to-card/50 backdrop-blur-sm border-border/50 shadow-2xl rounded-3xl overflow-hidden",onMouseEnter:()=>C(!0),onMouseLeave:()=>C(!1),children:[e.jsx("div",{className:m("absolute -inset-4 bg-gradient-to-r from-primary/20 via-accent/20 to-transparent rounded-3xl blur-xl transition-opacity duration-500",K?"opacity-70":"opacity-30")}),e.jsxs(te,{className:"text-center pb-6 relative z-10",children:[e.jsx(i.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.3},className:"mx-auto mb-4",children:e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-primary to-accent rounded-2xl flex items-center justify-center shadow-lg",children:e.jsx(ce,{className:"h-10 w-10 text-primary-foreground"})})}),e.jsx(oe,{className:"font-display text-3xl md:text-4xl mb-2",children:"Reset Password"}),e.jsx(ie,{className:"text-lg",children:"Create a new secure password for your account"})]}),e.jsx(ne,{className:"pb-6 relative z-10",children:e.jsx(E,{mode:"wait",children:B?e.jsxs(i.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"text-center py-4",children:[e.jsx(i.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.2},className:"w-24 h-24 bg-gradient-to-br from-green-100 to-green-50 rounded-full flex items-center justify-center mx-auto mb-6 border-2 border-green-200",children:e.jsx(me,{className:"w-12 h-12 text-green-600"})}),e.jsx("h3",{className:"text-2xl font-bold text-foreground mb-3",children:"Password Updated!"}),e.jsx("p",{className:"text-muted-foreground mb-8",children:"Your password has been successfully reset. You will be redirected to the login page shortly."}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-6",children:[e.jsx(O,{className:"h-5 w-5 animate-spin text-primary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Redirecting in 3 seconds..."})]}),e.jsxs(j,{onClick:()=>u("/login"),className:"gap-2 bg-gradient-to-r from-primary to-accent",children:["Go to Login",e.jsx(R,{className:"h-4 w-4"})]})]},"success"):e.jsxs(i.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},children:[e.jsxs("form",{onSubmit:J,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(M,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4"}),"New Password"]}),e.jsxs("div",{className:"relative group",children:[e.jsx(q,{type:w?"text":"password",placeholder:"••••••••",className:m("pl-12 pr-12 h-14 text-base rounded-xl border-2 bg-background/50","transition-all duration-300","focus:border-primary focus:ring-2 focus:ring-primary/20","group-hover:border-primary/50",l.password&&"border-destructive focus:border-destructive"),value:r.password,onChange:s=>P("password",s.target.value),required:!0}),e.jsx(h,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground transition-colors duration-300 group-hover:text-primary"}),e.jsx("button",{type:"button",onClick:()=>U(!w),className:"absolute right-4 top-1/2 -translate-y-1/2 p-1 hover:bg-muted rounded-lg transition-colors",children:w?e.jsx(z,{className:"h-5 w-5 text-muted-foreground"}):e.jsx(I,{className:"h-5 w-5 text-muted-foreground"})})]}),r.password&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-medium",children:"Password Strength"}),e.jsx("span",{className:m("text-xs font-bold",t>=80&&"text-emerald-600",t>=60&&t<80&&"text-amber-600",t>=40&&t<60&&"text-orange-600",t<40&&"text-red-600"),children:X()})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:m("h-full transition-all duration-300",W()),style:{width:`${t}%`}})})]}),r.password&&e.jsxs("div",{className:"p-4 bg-gradient-to-r from-muted/20 to-muted/10 rounded-xl border border-border/50",children:[e.jsx("h4",{className:"text-xs font-medium mb-2",children:"Password Requirements:"}),e.jsx("div",{className:"space-y-1.5",children:[{label:"At least 8 characters",met:x.length},{label:"One uppercase letter",met:x.uppercase},{label:"One lowercase letter",met:x.lowercase},{label:"One number",met:x.number},{label:"One special character",met:x.special}].map((s,a)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[s.met?e.jsx(A,{className:"h-3 w-3 text-emerald-600"}):e.jsx(F,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:s.met?"text-emerald-700":"text-muted-foreground",children:s.label})]},a))})]}),l.password&&e.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[e.jsx(D,{className:"h-3 w-3"}),l.password]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(M,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4"}),"Confirm Password"]}),e.jsxs("div",{className:"relative group",children:[e.jsx(q,{type:b?"text":"password",placeholder:"••••••••",className:m("pl-12 pr-12 h-14 text-base rounded-xl border-2 bg-background/50","transition-all duration-300","focus:border-primary focus:ring-2 focus:ring-primary/20","group-hover:border-primary/50",l.cpassword&&"border-destructive focus:border-destructive"),value:r.cpassword,onChange:s=>P("cpassword",s.target.value),required:!0}),e.jsx(h,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground transition-colors duration-300 group-hover:text-primary"}),e.jsx("button",{type:"button",onClick:()=>$(!b),className:"absolute right-4 top-1/2 -translate-y-1/2 p-1 hover:bg-muted rounded-lg transition-colors",children:b?e.jsx(z,{className:"h-5 w-5 text-muted-foreground"}):e.jsx(I,{className:"h-5 w-5 text-muted-foreground"})})]}),r.cpassword&&e.jsx("div",{className:"flex items-center gap-2 text-xs",children:r.password===r.cpassword?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"h-3 w-3 text-emerald-600"}),e.jsx("span",{className:"text-emerald-700",children:"Passwords match"})]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"h-3 w-3 text-destructive"}),e.jsx("span",{className:"text-destructive",children:"Passwords do not match"})]})}),l.cpassword&&e.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[e.jsx(D,{className:"h-3 w-3"}),l.cpassword]})]}),e.jsx(j,{type:"submit",disabled:y||t<80,className:m("w-full h-14 text-base font-medium rounded-xl","bg-gradient-to-r from-primary to-accent hover:from-primary/90 hover:to-accent/90","shadow-lg hover:shadow-xl transition-all duration-300","disabled:opacity-50 disabled:cursor-not-allowed","group"),children:e.jsx(E,{mode:"wait",children:y?e.jsxs(i.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"flex items-center gap-3",children:[e.jsx(O,{className:"h-5 w-5 animate-spin"}),"Updating Password..."]},"loading"):e.jsxs(i.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"flex items-center gap-3",children:["Reset Password",e.jsx(R,{className:"h-5 w-5 transition-transform group-hover:translate-x-1"})]},"default")})})]}),e.jsx(de,{className:"my-6"}),e.jsxs("div",{className:"p-4 bg-gradient-to-r from-primary/5 to-accent/5 rounded-2xl border border-primary/20",children:[e.jsxs("h4",{className:"font-medium mb-3 flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4 text-primary"}),"Security Tips"]}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-primary mt-1.5 flex-shrink-0"}),e.jsx("span",{children:"Use a unique password for this account"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-primary mt-1.5 flex-shrink-0"}),e.jsx("span",{children:"Consider using a password manager"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-primary mt-1.5 flex-shrink-0"}),e.jsx("span",{children:"Enable two-factor authentication after login"})]})]})]})]},"form")})}),e.jsx(le,{className:"border-t border-border/50 pt-6 relative z-10",children:e.jsxs("div",{className:"w-full text-center",children:[e.jsxs(j,{variant:"ghost",size:"sm",onClick:()=>u("/login"),className:"gap-2 text-muted-foreground hover:text-foreground",children:[e.jsx(ae,{className:"h-4 w-4"}),"Back to Login"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-4",children:["Having issues?"," ",e.jsx("a",{href:"mailto:support@doonneysbeauty.com",className:"text-primary hover:underline font-medium",children:"Contact Support"})]})]})})]}),e.jsx(i.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},className:"mt-6 flex items-center justify-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-card/80 backdrop-blur-sm rounded-full border border-border/50 shadow-lg",children:[e.jsx(h,{className:"h-3 w-3 text-primary"}),e.jsx("span",{className:"text-xs font-medium",children:"256-bit SSL • Encrypted Connection"})]})})]})]})})};export{ve as default};

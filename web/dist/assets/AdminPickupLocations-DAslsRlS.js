import{aN as he,F as ue,r as c,h as T,a6 as o,j as e,B as m,L as j,m as y,M as L,u as pe,v as je,N as ge,k as Ne,a5 as fe,a2 as H,at as ve,au as we,av as ye,aw as be,ax as R,ay as M,J as p}from"./index-DrzvgQSx.js";import{T as ke,a as Ce,b as U,c as x,d as Ae,e as h}from"./table-kDEzH9s1.js";import{A as _e,b as Se,c as De,d as Te,e as Le,f as Me,g as Pe,h as $e}from"./alert-dialog-DhLhMJxG.js";import{C as g,d as N,a as Ee,b as Be,c as Fe}from"./card-CSdj4VlM.js";import{P as b}from"./progress-DNf4bHVP.js";import{S as q,a as V,b as G,c as O,d}from"./select-CeCrIOLN.js";import{S as Ie}from"./switch-BNZbPRLI.js";import{R as ze}from"./refresh-cw-B2nHbzn8.js";import{P}from"./plus-CdXz1Jo6.js";import{C as Q}from"./circle-check-big-Cc93Cm_Q.js";import{G as He}from"./globe-Bi4Vt5-U.js";import{U as $}from"./users-BACZCDYD.js";import{F as Re}from"./filter-D38QoaQC.js";import{C as Ue}from"./clock-B9_Mht4K.js";import{S as W}from"./square-pen-BAbl0GsK.js";import{N as qe}from"./navigation-CYup7lq0.js";import{E as Ve}from"./ellipsis-CiWrXJQx.js";import{E as Ge}from"./external-link-YQ5zDcFs.js";import{T as J}from"./trash-2-DF_8SWob.js";import{B as X}from"./building-DyFMd_br.js";import{S as K}from"./store-Cjxw61W-.js";import{C as Oe}from"./circle-alert-D5MbGcH3.js";import{C as Qe}from"./circle-x-DMFlKDxD.js";import"./index-BdQq_4o_.js";import"./index-DDpYfoMH.js";import"./chevron-up-DEDQgLDp.js";const ws=()=>{const{activate_deactivate_pickup_location:E,add_pickup_location:k,delete_pickup_location:C,edit_pickup_location:B,view_pickup_location:Y}=he(["activate_deactivate_pickup_location","add_pickup_location","delete_pickup_location","edit_pickup_location","view_pickup_location"]),Z=ue(),[f,ee]=c.useState(""),[r,F]=c.useState([]),[A,se]=c.useState("all"),[_,ae]=c.useState("all"),[te,v]=c.useState(!1),[i,w]=c.useState(null);c.useEffect(()=>{if(!Y){c.startTransition(()=>Z("/unauthorized"));return}I()},[]);const I=async()=>{try{const l=(await T.get("/get-pickup-locations/")).data;if(!l.error&&l.data){F(l.data);return}o.error("Error fetching pickup locations")}catch(s){console.error("Error fetching pickup locations:",s),o.error("Error fetching pickup locations")}},a=c.useMemo(()=>{const s=r.length,l=r.filter(t=>t.status==="active").length,n=r.filter(t=>t.type==="store").length,S=r.filter(t=>t.type==="warehouse").length,de=r.filter(t=>t.type==="partner").length,me=Array.from(new Set(r.map(t=>t.city))).map(t=>{const u=r.filter(D=>D.city===t);return{name:t,count:u.length,active:u.filter(D=>D.status==="active").length}}).sort((t,u)=>u.count-t.count),xe=[...r].sort((t,u)=>new Date(u.lastUpdated).getTime()-new Date(t.lastUpdated).getTime()).slice(0,3);return{totalAddresses:s,activeAddresses:l,stores:n,warehouses:S,partners:de,cities:me,recentlyUpdated:xe}},[r]),z=r.filter(s=>(s.name.toLowerCase().includes(f.toLowerCase())||s.city.toLowerCase().includes(f.toLowerCase())||s.address.toLowerCase().includes(f.toLowerCase()))&&(A==="all"||s.type===A)&&(_==="all"||s.status===_)),re=s=>{switch(s){case"store":return e.jsx(K,{className:"h-4 w-4"});case"warehouse":return e.jsx(X,{className:"h-4 w-4"});case"partner":return e.jsx($,{className:"h-4 w-4"});default:return e.jsx(L,{className:"h-4 w-4"})}},le=s=>{switch(s){case"store":return e.jsxs(p,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:[e.jsx(K,{className:"h-3 w-3 mr-1"})," Store"]});case"warehouse":return e.jsxs(p,{variant:"outline",className:"bg-orange-50 text-orange-700 border-orange-200",children:[e.jsx(X,{className:"h-3 w-3 mr-1"})," Warehouse"]});case"partner":return e.jsxs(p,{variant:"outline",className:"bg-purple-50 text-purple-700 border-purple-200",children:[e.jsx($,{className:"h-3 w-3 mr-1"})," Partner"]});default:return null}},ie=s=>{switch(s){case"active":return e.jsxs(p,{className:"bg-green-100 text-green-800 border-green-200",children:[e.jsx(Q,{className:"h-3 w-3 mr-1"})," Active"]});case"inactive":return e.jsxs(p,{variant:"outline",className:"text-muted-foreground",children:[e.jsx(Qe,{className:"h-3 w-3 mr-1"})," Inactive"]});case"maintenance":return e.jsxs(p,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:[e.jsx(Oe,{className:"h-3 w-3 mr-1"})," Maintenance"]});default:return null}},ce=s=>{w(s),v(!0)},ne=async()=>{if(C&&i)try{const l=(await T.post("/delete-pickup-location/",{id:i.id})).data;if(!l.error&&l.data){o.success(`${i.name} has been removed from pickup locations.`),F(n=>n.filter(S=>S.id!==i.id));return}o.error(`${i.name} could not be removed from pickup locations.`),v(!1),w(null)}catch{o.error(`${i.name} could not be removed from pickup locations.`),v(!1),w(null)}},oe=async s=>{if(E)try{const n=(await T.post("/toggle-pickup-location/",{id:s})).data;if(!n.error&&n.data){o.success(`${n.data.name} status has been updated.`),I();return}o.error(`${n.data.name} status could not be updated.`)}catch{o.error("An error occurred while updating the status.")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"font-display text-2xl md:text-3xl mb-2",children:"Pickup Locations"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage all pickup locations"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(m,{variant:"outline",className:"gap-2",children:[e.jsx(ze,{className:"h-4 w-4"}),"Refresh"]}),k&&e.jsx(m,{asChild:!0,children:e.jsxs(j,{to:"/admin/pickup-location/new",className:"gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),"Add New Location"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsx(g,{className:"bg-gradient-to-br from-blue-50 to-blue-100/50 border-blue-200",children:e.jsxs(N,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Total Locations"}),e.jsx("h3",{className:"text-2xl font-bold mt-2",children:a.totalAddresses}),e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[a.activeAddresses," active • ",a.stores," stores"]})]}),e.jsx("div",{className:"p-3 rounded-full bg-blue-100",children:e.jsx(L,{className:"h-5 w-5 text-blue-600"})})]}),e.jsx(b,{value:a.activeAddresses/a.totalAddresses*100,className:"h-1 mt-4 bg-blue-200"})]})})}),e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsx(g,{className:"bg-gradient-to-br from-green-50 to-green-100/50 border-green-200",children:e.jsxs(N,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Active Locations"}),e.jsx("h3",{className:"text-2xl font-bold mt-2",children:a.activeAddresses}),e.jsxs("p",{className:"text-xs text-green-600 mt-1",children:[Math.round(a.activeAddresses/a.totalAddresses*100),"% active rate"]})]}),e.jsx("div",{className:"p-3 rounded-full bg-green-100",children:e.jsx(Q,{className:"h-5 w-5 text-green-600"})})]}),e.jsx(b,{value:a.activeAddresses/a.totalAddresses*100,className:"h-1 mt-4 bg-green-200"})]})})}),e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsx(g,{className:"bg-gradient-to-br from-purple-50 to-purple-100/50 border-purple-200",children:e.jsxs(N,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-purple-800",children:"Cities Coverage"}),e.jsx("h3",{className:"text-2xl font-bold mt-2",children:a.cities.length}),e.jsxs("p",{className:"text-xs text-purple-600 mt-1",children:[a.totalAddresses," total locations"]})]}),e.jsx("div",{className:"p-3 rounded-full bg-purple-100",children:e.jsx(He,{className:"h-5 w-5 text-purple-600"})})]}),e.jsx(b,{value:Math.min(a.activeAddresses/a.totalAddresses*100,100),className:"h-1 mt-4 bg-purple-200"})]})})}),e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:e.jsx(g,{className:"bg-gradient-to-br from-orange-50 to-orange-100/50 border-orange-200",children:e.jsxs(N,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-800",children:"Partner Locations"}),e.jsx("h3",{className:"text-2xl font-bold mt-2",children:a.partners}),e.jsxs("p",{className:"text-xs text-orange-600 mt-1",children:[a.warehouses," warehouses • ",a.stores," stores"]})]}),e.jsx("div",{className:"p-3 rounded-full bg-orange-100",children:e.jsx($,{className:"h-5 w-5 text-orange-600"})})]}),e.jsx(b,{value:a.partners/a.totalAddresses*100,className:"h-1 mt-4 bg-orange-200"})]})})})]}),e.jsxs(g,{children:[e.jsxs(Ee,{children:[e.jsx(Be,{children:"All Pickup Locations"}),e.jsx(Fe,{children:"Manage pickup addresses, edit details, and update status"})]}),e.jsx(N,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[e.jsxs("div",{className:"flex gap-3 flex-1",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(pe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(je,{placeholder:"Search by name, address, or city...",value:f,onChange:s=>ee(s.target.value),className:"pl-9"})]}),e.jsxs(q,{value:A,onValueChange:se,children:[e.jsxs(V,{className:"w-[140px]",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),e.jsx(G,{placeholder:"Type"})]}),e.jsxs(O,{children:[e.jsx(d,{value:"all",children:"All Types"}),e.jsx(d,{value:"store",children:"Store"}),e.jsx(d,{value:"warehouse",children:"Warehouse"}),e.jsx(d,{value:"partner",children:"Partner"})]})]}),e.jsxs(q,{value:_,onValueChange:ae,children:[e.jsxs(V,{className:"w-[140px]",children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),e.jsx(G,{placeholder:"Status"})]}),e.jsxs(O,{children:[e.jsx(d,{value:"all",children:"All Status"}),e.jsx(d,{value:"active",children:"Active"}),e.jsx(d,{value:"inactive",children:"Inactive"}),e.jsx(d,{value:"maintenance",children:"Maintenance"})]})]})]}),k&&e.jsx(m,{asChild:!0,children:e.jsxs(j,{to:"/admin/pickup-location/new",className:"gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),"Add Location"]})})]}),e.jsx("div",{className:"rounded-lg border overflow-hidden",children:e.jsxs(ke,{children:[e.jsx(Ce,{children:e.jsxs(U,{children:[e.jsx(x,{children:"Name"}),e.jsx(x,{children:"Type"}),e.jsx(x,{children:"Address"}),e.jsx(x,{children:"Contact"}),e.jsx(x,{children:"Hours"}),e.jsx(x,{children:"Status"}),e.jsx(x,{className:"text-right",children:"Actions"})]})}),e.jsx(Ae,{children:z.map(s=>e.jsxs(U,{className:"hover:bg-muted/50",children:[e.jsxs(h,{className:"font-medium",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[re(s.type),e.jsx("span",{children:s.name})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.manager})]}),e.jsx(h,{children:le(s.type)}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm",children:s.address}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.city,", ",s.state," ",s.zipCode]})]})}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(Ne,{className:"h-3 w-3"}),s.contactPhone]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(fe,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",children:s.contactEmail})]})]})}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(Ue,{className:"h-3 w-3"}),"Mon-Fri: ",s.hours.monday.split(" - ")[0]]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Today: ",new Date().getDay()===0?s.hours.sunday:new Date().getDay()===6?s.hours.saturday:s.hours.monday]})]})}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[ie(s.status),E&&e.jsx(Ie,{checked:s.status==="active",onCheckedChange:()=>oe(s.id)})]})}),e.jsx(h,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[B&&e.jsx(m,{asChild:!0,variant:"ghost",size:"icon",children:e.jsx(j,{to:`/admin/pickup-location/${s.id}/${H(s.name)}`,children:e.jsx(W,{className:"h-4 w-4"})})}),s.coordinates.lat&&s.coordinates.lng&&e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>window.open(`https://maps.google.com/?q=${s.coordinates.lat},${s.coordinates.lng}`,"_blank"),children:e.jsx(qe,{className:"h-4 w-4"})}),e.jsxs(ve,{children:[e.jsx(we,{asChild:!0,children:e.jsx(m,{variant:"ghost",size:"icon",children:e.jsx(Ve,{className:"h-4 w-4"})})}),e.jsxs(ye,{align:"end",children:[e.jsx(be,{children:"Actions"}),B&&e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx(M,{asChild:!0,children:e.jsxs(j,{to:`/admin/pickup-location/${s.id}/${H(s.name)}`,className:"cursor-pointer",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Edit Details"]})})]}),s.coordinates.lat&&s.coordinates.lng&&e.jsxs(e.Fragment,{children:[e.jsxs(M,{onClick:()=>window.open(`https://maps.google.com/?q=${s.coordinates.lat},${s.coordinates.lng}`,"_blank"),children:[e.jsx(Ge,{className:"h-4 w-4 mr-2"}),"Open in Maps"]}),e.jsx(R,{})]}),C&&e.jsxs(M,{onClick:()=>ce(s),className:"text-red-600 cursor-pointer",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Delete Location"]})]})]})]})})]},s.id))})]})}),z.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(L,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No pickup locations found"}),k&&e.jsx(m,{asChild:!0,variant:"outline",className:"mt-4",children:e.jsxs(j,{to:"/admin/pickup-location/new",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Add First Location"]})})]})]})})]}),C&&e.jsx(_e,{open:te,onOpenChange:v,children:e.jsxs(Se,{children:[e.jsxs(De,{children:[e.jsx(Te,{children:"Delete Pickup Location"}),e.jsxs(Le,{children:["Are you sure you want to delete ",e.jsx("strong",{children:i==null?void 0:i.name}),"? This action cannot be undone. This will remove the location from all customer pickup options."]})]}),e.jsxs(Me,{children:[e.jsx(Pe,{onClick:()=>w(null),children:"Cancel"}),e.jsxs($e,{onClick:ne,className:"bg-red-600 hover:bg-red-700",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Delete Location"]})]})]})})]})};export{ws as default};
